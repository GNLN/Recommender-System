<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>R_Clsutering_K_Means - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"maxCustomTags":45,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","compute_units":26.0,"number_of_ips":15,"local_disks":1,"reserved_compute_units":3.64,"memory_mb":62464,"num_cores":8,"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 RC2 (Scala 2.11)","packageLabel":"spark-image-3053719f98bccbb1f0410e1420ee81a22e521a0b43b6f220c318f10d281646ff","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"Spark 2.2 RC2 (Experimental, Scala 2.11)","packageLabel":"spark-image-a89bff416842ec8c30d33a1b5aaf3683d4712ea02d0cb2d0e7fbaabfb1b9d42d","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 RC2 (Scala 2.10)","packageLabel":"spark-image-756e80c1f48863a7b837dca26e0a844bb2f9fe5eddf1fb6c9b69c0cf4a19cb71","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"Spark 2.2 RC2 (Experimental, Scala 2.10)","packageLabel":"spark-image-362326e9095981c5f1c0049a535cc25434770e7b861104e90ebddd37a302dd1f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.45","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"8cfae650235ae51451a79cd868de7b82ce94aa21","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":false,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":true,"enableEBSVolumesUIByTier":false,"enableNewJobClusterEdit":false,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2339042375726852,"name":"R_Clsutering_K_Means","language":"r","commands":[{"version":"CommandV1","origId":2339042375726854,"guid":"5972b2e9-9a97-41f6-8587-8d98a58e886f","subtype":"command","commandType":"auto","position":1.0,"command":"filepath <- file.path('','mnt','bucket1prad','sampled_train.csv')\ndf <- read.df(sqlContext, filepath, header='true', source = \"com.databricks.spark.csv\", inferSchema='true')\n\nfilepath <- file.path('','mnt','bucket1prad','sampled_test.csv')\ntest <- read.df(sqlContext, filepath, header='true', source = \"com.databricks.spark.csv\", inferSchema='true')\ntraining <- df\n#test <- df\n\n#hotelDF <- suppressWarnings(createDataFrame(iris))\n#kmeansDF <- irisDF\n#kmeansTestDF <- irisDF\nkmeansModel <- spark.kmeans(training, hotel_cluster ~ is_booking+site_name+posa_continent+site_name+user_location_country+user_location_city+user_location_region+user_id+is_package+is_mobile+ channel +hotel_continent + hotel_country+ hotel_market+ srch_destination_id, k = 150)\n\n# Model summary\nsummary(kmeansModel)\n\n# Get fitted result from the k-means model\nshowDF(fitted(kmeansModel))\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<pre style=\"font-size:10p\"></pre><pre style = 'font-size:10pt'>+----+--------------------+---------+--------------+---------------------+--------------------+------------------+-------------------------+-------+---------+----------+-------+----------+----------+---------------+-----------------+-----------+-------------------+------------------------+----------+---+---------------+-------------+------------+-------------+----+-----+-----+----------+\n| _c0|           date_time|site_name|posa_continent|user_location_country|user_location_region|user_location_city|orig_destination_distance|user_id|is_mobile|is_package|channel|   srch_ci|   srch_co|srch_adults_cnt|srch_children_cnt|srch_rm_cnt|srch_destination_id|srch_destination_type_id|is_booking|cnt|hotel_continent|hotel_country|hotel_market|hotel_cluster|year|month|label|prediction|\n+----+--------------------+---------+--------------+---------------------+--------------------+------------------+-------------------------+-------+---------+----------+-------+----------+----------+---------------+-----------------+-----------+-------------------+------------------------+----------+---+---------------+-------------+------------+-------------+----+-----+-----+----------+\n|4003|2013-01-07 16:28:...|        2|             3|                   66|                 254|             46142|                 736.2199|  23532|        1|         0|      2|2013-02-04|2013-02-07|              2|                0|          1|               3414|                       3|         0|  7|              2|           50|         350|           48|2013|    1| 48.0|         6|\n|4004|2013-01-09 20:57:...|        2|             3|                   66|                 254|             46142|                 736.2199|  23532|        1|         0|      2|2013-02-04|2013-02-07|              2|                0|          1|               3414|                       3|         0|  1|              2|           50|         350|           48|2013|    1| 48.0|         6|\n|4005|2013-01-10 15:56:...|        2|             3|                   66|                 254|             46142|                 736.2199|  23532|        0|         0|      2|2013-02-03|2013-02-06|              2|                0|          1|               3414|                       3|         0|  2|              2|           50|         350|           48|2013|    1| 48.0|         6|\n|4006|2013-01-10 16:01:...|        2|             3|                   66|                 254|             46142|                 736.2199|  23532|        0|         0|      2|2013-02-04|2013-02-07|              2|                0|          1|               3414|                       3|         0|  1|              2|           50|         350|           48|2013|    1| 48.0|         6|\n|4007|2013-01-10 16:04:...|        2|             3|                   66|                 254|             46142|                 736.2199|  23532|        0|         0|      2|2013-02-04|2013-02-07|              2|                0|          1|               3414|                       3|         1|  1|              2|           50|         350|           48|2013|    1| 48.0|         6|\n|4008|2013-01-11 06:46:...|        2|             3|                   66|                 254|             46142|                 835.1126|  23532|        0|         0|      2|2013-02-03|2013-02-06|              2|                1|          1|               8266|                       1|         0|  1|              2|           50|         411|           28|2013|    1| 28.0|         6|\n|4009|2013-01-13 07:44:...|        2|             3|                   66|                 254|             21713|                1109.9841|  23532|        1|         0|      2|2013-02-07|2013-02-08|              2|                0|          1|              15093|                       1|         0|  3|              2|           50|         679|           71|2013|    1| 71.0|       126|\n|4010|2013-01-13 08:07:...|        2|             3|                   66|                 254|             21713|                 1112.609|  23532|        1|         0|      2|2013-02-07|2013-02-08|              2|                0|          1|              15093|                       1|         0|  1|              2|           50|         679|           50|2013|    1| 50.0|       126|\n|4011|2013-02-03 14:38:...|        2|             3|                   66|                 363|             46852|                     null|  23532|        1|         0|      1|2013-02-03|2013-02-04|              2|                0|          1|               1121|                       3|         1|  1|              2|           50|        1054|           47|2013|    2| 47.0|         6|\n|4012|2013-02-07 13:40:...|        2|             3|                   66|                 442|             18617|                     null|  23532|        1|         0|      2|2013-02-07|2013-02-08|              2|                0|          1|              28554|                       6|         0|  4|              2|           50|         582|           32|2013|    2| 32.0|       126|\n|4013|2013-02-07 13:53:...|        2|             3|                   66|                 442|             18617|                     null|  23532|        1|         0|      2|2013-02-07|2013-02-08|              2|                0|          1|              28554|                       6|         1|  1|              2|           50|         582|           32|2013|    2| 32.0|       126|\n|4014|2013-02-26 05:30:...|        2|             3|                   66|                 220|             18876|       357.68199999999996|  23532|        1|         0|      0|2013-02-26|2013-02-27|              2|                0|          1|              14803|                       1|         0|  3|              2|           50|         558|           77|2013|    2| 77.0|       126|\n|4015|2013-02-26 05:34:...|        2|             3|                   66|                 220|             18876|       357.68199999999996|  23532|        1|         0|      0|2013-02-26|2013-02-27|              2|                0|          1|               1325|                       3|         0|  1|              2|           50|         558|           77|2013|    2| 77.0|       144|\n|4016|2013-02-26 05:37:...|        2|             3|                   66|                 220|             18876|       357.68199999999996|  23532|        1|         0|      0|2013-02-26|2013-02-27|              2|                0|          1|               1325|                       3|         1|  1|              2|           50|         558|           77|2013|    2| 77.0|       144|\n|4017|2013-06-17 16:24:...|        2|             3|                   66|                 254|             41165|                 787.6632|  23532|        1|         0|      2|2013-09-18|2013-09-24|              2|                0|          1|               8842|                       1|         0|  1|              2|           50|         669|           44|2013|    6| 44.0|         6|\n|4018|2013-06-17 16:25:...|        2|             3|                   66|                 254|             41165|                 787.5926|  23532|        1|         0|      2|2013-09-18|2013-09-24|              2|                0|          1|               8842|                       1|         0|  1|              2|           50|         669|           63|2013|    6| 63.0|         6|\n|4019|2013-06-17 16:27:...|        2|             3|                   66|                 254|             41165|                 787.5926|  23532|        1|         0|      2|2013-09-17|2013-09-23|              2|                0|          1|               8842|                       1|         0|  1|              2|           50|         669|           63|2013|    6| 63.0|         6|\n|4020|2013-08-08 19:58:...|        2|             3|                   66|                 254|             21713|                 954.9262|  23532|        1|         0|      2|2013-10-20|2013-10-24|              2|                0|          1|              26051|                       6|         0|  2|              2|           50|        1235|           15|2013|    8| 15.0|       126|\n|4021|2013-08-08 20:07:...|        2|             3|                   66|                 254|             21713|                 954.6204|  23532|        1|         0|      2|2013-10-20|2013-10-24|              2|                0|          1|              26051|                       6|         0|  1|              2|           50|        1235|           47|2013|    8| 47.0|       126|\n|4022|2013-08-17 11:23:...|        2|             3|                   66|                 254|             21713|                 954.6204|  23532|        1|         0|      2|2013-10-20|2013-10-23|              2|                0|          1|              17563|                       1|         0|  1|              2|           50|        1235|           47|2013|    8| 47.0|       126|\n+----+--------------------+---------+--------------+---------------------+--------------------+------------------+-------------------------+-------+---------+----------+-------+----------+----------+---------------+-----------------+-----------+-------------------+------------------------+----------+---+---------------+-------------+------------+-------------+----+-----+-----+----------+\nonly showing top 20 rows</pre>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<code style=\"font-size:10p\"> Error in eval(expr, envir, enclos) : object 'irisDF' not found </code>","error":"<pre style=\"font-size:10p\">Error in eval(expr, envir, enclos) : object 'irisDF' not found\nIn addition: Warning messages:\n1: In odbcDriverConnect(&quot;DSN=spark;UID=root&quot;) :\n  [RODBC] ERROR: state HY000, code 34, message [unixODBC][Simba][SparkODBC] (34) Error from Spark: No more data to read..\n2: In odbcDriverConnect(&quot;DSN=spark;UID=root&quot;) : ODBC connection failed\n3: 'sparkR.init' is deprecated.\nUse 'sparkR.session' instead.\nSee help(&quot;Deprecated&quot;) \n4: 'read.df(sqlContext...)' is deprecated.\nUse 'read.df(path = NULL, source = NULL, schema = NULL, ...)' instead.\nSee help(&quot;Deprecated&quot;) \n5: 'read.df(sqlContext...)' is deprecated.\nUse 'read.df(path = NULL, source = NULL, schema = NULL, ...)' instead.\nSee help(&quot;Deprecated&quot;) </pre>","workflows":[],"startTime":1494993690442,"submitTime":1494993690429,"finishTime":1494993717265,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e908137b-e642-453d-909b-03ab9594f637"},{"version":"CommandV1","origId":2339042375726856,"guid":"47494f50-333c-4db5-a1ad-bce1317a8dd4","subtype":"command","commandType":"auto","position":2.0,"command":"\n# Prediction\nkmeansPredictions <- predict(kmeansModel, test)\nshowDF(kmeansPredictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<pre style=\"font-size:10p\"></pre><pre style = 'font-size:10pt'>+------+--------------------+---------+--------------+---------------------+--------------------+------------------+-------------------------+-------+---------+----------+-------+--------------------+--------------------+---------------+-----------------+-----------+-------------------+------------------------+----------+---+---------------+-------------+------------+-------------+----+-----+-----+----------+\n|   _c0|           date_time|site_name|posa_continent|user_location_country|user_location_region|user_location_city|orig_destination_distance|user_id|is_mobile|is_package|channel|             srch_ci|             srch_co|srch_adults_cnt|srch_children_cnt|srch_rm_cnt|srch_destination_id|srch_destination_type_id|is_booking|cnt|hotel_continent|hotel_country|hotel_market|hotel_cluster|year|month|label|prediction|\n+------+--------------------+---------+--------------+---------------------+--------------------+------------------+-------------------------+-------+---------+----------+-------+--------------------+--------------------+---------------+-----------------+-----------+-------------------+------------------------+----------+---+---------------+-------------+------------+-------------+----+-----+-----+----------+\n|  4084|2014-11-03 15:57:...|        2|             3|                   66|                 254|             21713|                1583.6919|  23532|        1|         0|      0|2015-03-07 00:00:...|2015-03-08 00:00:...|              4|                0|          2|               8824|                       1|         1|  1|              4|            8|         118|           30|2014|   11| 30.0|       126|\n| 58406|2014-08-21 09:03:...|        2|             3|                   66|                 348|             48862|                5120.4763| 202772|        0|         0|      9|2015-06-03 00:00:...|2015-06-07 00:00:...|              2|                0|          1|              23731|                       1|         1|  1|              6|           22|         301|           86|2014|    8| 86.0|        10|\n| 66885|2014-10-27 05:46:...|       37|             1|                   69|                 692|             45077|                     null| 245369|        1|         1|      9|2014-11-19 00:00:...|2014-11-23 00:00:...|              2|                0|          1|               8250|                       1|         1|  1|              2|           50|         628|            1|2014|   10|  1.0|        36|\n| 67583|2014-09-29 19:16:...|        2|             3|                   66|                 258|             31978|                1199.4232| 249659|        0|         1|      3|2014-12-30 00:00:...|2015-01-04 00:00:...|              2|                0|          1|               8260|                       1|         1|  1|              2|           50|         701|           13|2014|    9| 13.0|        36|\n| 67585|2014-11-15 14:44:...|        2|             3|                   66|                 258|             16411|                 686.7324| 249659|        0|         0|      0|2015-01-30 00:00:...|2015-01-31 00:00:...|              2|                0|          1|              13517|                       4|         1|  1|              2|           50|         696|           50|2014|   11| 50.0|       113|\n| 67588|2014-11-15 14:56:...|        2|             3|                   66|                 258|             16411|                 700.6146| 249659|        0|         1|      0|2015-01-22 00:00:...|2015-01-23 00:00:...|              1|                0|          1|                764|                       1|         1|  1|              2|           50|         733|           10|2014|   11| 10.0|       113|\n| 74425|2014-11-13 16:09:...|        2|             3|                  209|                 187|             12365|                     null| 299037|        0|         1|      9|2014-11-20 00:00:...|2014-11-29 00:00:...|              1|                0|          1|               1114|                       1|         1|  1|              4|            8|         122|            5|2014|   11|  5.0|       110|\n| 76797|2014-08-26 15:04:...|        2|             3|                   66|                 363|             22089|                   15.841| 309639|        0|         0|      0|2014-10-12 00:00:...|2014-10-13 00:00:...|              2|                0|          1|              25800|                       6|         1|  1|              2|           50|         696|           95|2014|    8| 95.0|         7|\n| 76801|2014-10-26 18:19:...|        2|             3|                   66|                 363|             25548|                     null| 309639|        0|         0|      0|2014-12-13 00:00:...|2014-12-14 00:00:...|              4|                0|          2|               8219|                       1|         1|  1|              2|           50|         688|           18|2014|   10| 18.0|       110|\n| 87913|2014-10-13 09:57:...|       11|             3|                  205|                 354|             25315|                 351.6223| 351456|        1|         1|      0|2014-10-26 00:00:...|2014-10-30 00:00:...|              2|                0|          1|               8291|                       1|         1|  1|              2|           50|         191|            9|2014|   10|  9.0|       118|\n| 97193|2014-11-24 06:37:...|       24|             2|                    3|                  50|              5703|                     null| 380785|        1|         1|      1|2014-12-12 00:00:...|2014-12-14 00:00:...|              2|                0|          1|               8818|                       1|         1|  1|              3|           99|          88|           81|2014|   11| 81.0|       109|\n|105437|2014-11-18 10:01:...|        2|             3|                   66|                 174|             24103|                 228.2944| 406020|        0|         1|      0|2014-11-24 00:00:...|2014-11-27 00:00:...|              2|                0|          1|               8250|                       1|         1|  1|              2|           50|         628|           24|2014|   11| 24.0|        13|\n|112351|2014-08-05 08:24:...|       11|             3|                   66|                 174|             54089|       395.49300000000005| 426506|        0|         1|      9|2014-10-01 00:00:...|2014-10-04 00:00:...|              1|                0|          1|               8250|                       1|         1|  1|              2|           50|         628|           54|2014|    8| 54.0|        84|\n|121666|2014-08-25 19:10:...|        2|             3|                   66|                 351|             36508|                 153.7353| 455401|        0|         0|      0|2014-08-29 00:00:...|2014-08-30 00:00:...|              2|                0|          1|              12015|                       1|         1|  1|              2|           50|         527|           42|2014|    8| 42.0|       124|\n|121668|2014-08-25 19:13:...|        2|             3|                   66|                 351|             36508|                  298.121| 455401|        0|         0|      0|2014-08-30 00:00:...|2014-09-01 00:00:...|              2|                0|          1|              27598|                       6|         1|  1|              2|           50|         642|           30|2014|    8| 30.0|       124|\n|121714|2014-11-16 19:21:...|        2|             3|                   66|                 351|             36508|                1763.4478| 455401|        0|         0|      0|2014-12-20 00:00:...|2014-12-21 00:00:...|              3|                0|          1|               8250|                       1|         1|  1|              2|           50|         628|           45|2014|   11| 45.0|       124|\n|154035|2014-10-07 12:53:...|        2|             3|                   66|                 462|             49272|                 877.3346| 584893|        0|         1|      9|2014-11-20 00:00:...|2014-11-23 00:00:...|              2|                0|          1|               8250|                       1|         1|  1|              2|           50|         628|           19|2014|   10| 19.0|        83|\n|154041|2014-11-11 10:25:...|        2|             3|                   66|                 462|             49272|                 876.5673| 584893|        0|         1|      9|2014-11-18 00:00:...|2014-11-24 00:00:...|              2|                0|          1|               8250|                       1|         1|  1|              2|           50|         628|            1|2014|   11|  1.0|        83|\n|160189|2014-08-18 17:26:...|        2|             3|                   66|                 331|             55101|                 139.5149| 605591|        0|         0|      9|2014-08-19 00:00:...|2014-08-20 00:00:...|              1|                0|          1|              26374|                       1|         1|  1|              2|           50|         884|           53|2014|    8| 53.0|        83|\n|160198|2014-09-24 19:42:...|        2|             3|                   66|                 331|             55101|                 337.8951| 605591|        1|         0|      9|2014-10-08 00:00:...|2014-10-12 00:00:...|              2|                0|          1|              25817|                       6|         1|  1|              2|           50|         697|           42|2014|    9| 42.0|        83|\n+------+--------------------+---------+--------------+---------------------+--------------------+------------------+-------------------------+-------+---------+----------+-------+--------------------+--------------------+---------------+-----------------+-----------+-------------------+------------------------+----------+---+---------------+-------------+------------+-------------+----+-----+-----+----------+\nonly showing top 20 rows</pre>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494993728398,"submitTime":1494993728387,"finishTime":1494993728845,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f11cad6-1f5c-4974-bd9f-353e95f6225e"},{"version":"CommandV1","origId":2339042375726857,"guid":"304eb292-32f7-457e-bf27-4e3def470d83","subtype":"command","commandType":"auto","position":3.0,"command":"totalrows<- nrow(test)\nkmeansPredictions$result<- ifelse((kmeansPredictions$hotel_cluster== kmeansPredictions$prediction), 1 , 0)\ncorrect<- nrow(kmeansPredictions[kmeansPredictions$result == 1,])\naccuracy_km <- correct/totalrows","commandVersion":0,"state":"finished","results":{"type":"html","data":"<pre style=\"font-size:10p\"></pre><pre style = 'font-size:10pt'></pre>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<code style=\"font-size:10p\"> Error in nrow(kmeansPredictions[kmeansPredcitions$result == 1, ]) :  </code>","error":"<pre style=\"font-size:10p\">Error in nrow(kmeansPredictions[kmeansPredcitions$result == 1, ]) : \n  error in evaluating the argument 'x' in selecting a method for function 'nrow': Error in kmeansPredictions[kmeansPredcitions$result == 1, ] : \n  object 'kmeansPredcitions' not found\nCalls: [ -&gt; [\n</pre>","workflows":[],"startTime":1494993753638,"submitTime":1494993753628,"finishTime":1494993754236,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3a62d80d-3aab-43df-95e5-f4ec944829c3"},{"version":"CommandV1","origId":2339042375726858,"guid":"87b32628-6963-43ff-ae9c-a687985d051b","subtype":"command","commandType":"auto","position":4.0,"command":"print(accuracy_km)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<pre style=\"font-size:10p\"></pre><pre style = 'font-size:10pt'>[1] 0.007302824</pre>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<code style=\"font-size:10p\"> Error in print(accuracy_lr) : object 'accuracy_lr' not found </code>","error":"<pre style=\"font-size:10p\">Error in print(accuracy_lr) : object 'accuracy_lr' not found</pre>","workflows":[],"startTime":1494993757463,"submitTime":1494993757450,"finishTime":1494993757479,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"63abfc92-f588-4a5c-a279-e1c800d150b0"},{"version":"CommandV1","origId":2339042375726859,"guid":"4f750f75-1e55-4e3c-8019-dbf444a83f3b","subtype":"command","commandType":"auto","position":5.0,"command":"a<-nrow(kmeansPredictions$hotel_cluster== kmeansPredictions$prediction)\nprint(a)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<pre style=\"font-size:10p\"></pre><pre style = 'font-size:10pt'>NULL</pre>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494993999394,"submitTime":1494993999386,"finishTime":1494993999405,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"166300b2-c690-460a-bc0e-837b9bca3927"}],"dashboards":[],"guid":"0fcecb09-6a5a-48fd-bfe1-87924f2232f6","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
